<!DOCTYPE html>
<html>
<head>
    <% include ../partials/header.ejs %>
</head>

<body>
    <% include ../partials/nav.ejs %>
    
    <h1>Nighttime Encounter Generator</h1>
    <p>When you're camping at night, you may want someone to keep watch of 
        your surroundings. Otherwise, you may end up finding something or
        someone approaching your campsite.
    </p>
    <p>A random encounter is generated by rolling a virtual d100
        and presenting that choice based on a lookup table.
    </p>
    <p>If one is more interested, they can use the advanced table,
        which uses a d1000 for a lookup table.
    </p>
    <p>Using the dropdown, one can select the environment for a more
        realistic set of encounters.
    </p>
    
    <a href='https://github.com/Fleker/mydnd-party/issues/new' target="_blank" id='suggest_item'>Make a suggestion</a> 
    
    <div id='content'></div>

    <select id='environment'>
        <option value="woods">Woods</option>
    </select>
    <button onclick='reroll(100)' class='reroll'>Re-Roll</button>
    <button onclick='reroll(1000)' class='reroll'>Roll Advanced Table</button>

    <script>
        addToLookupTable('Nothing', 0, 50, 'woods');
        addToLookupTable('Nothing', 101, 510, 'woods');
        addToLookupTable('Fox', 51, 60, 'woods');
        addToLookupTable('Fox', 511, 610, 'woods');
        addToLookupTable('Raccoon', 61, 65, 'woods');
        addToLookupTable('Raccoon', 611, 640, 'woods');
        addToLookupTable('Raccoon with rabies', 641, 650, 'woods');
        addToLookupTable('Wolf', 66, 70, 'woods');
        addToLookupTable('Wolf', 661, 690, 'woods');
        addToLookupTable('Pack of wolves', 691, 700, 'woods');
        addToLookupTable('Bear', 71, 80, 'woods');
        addToLookupTable('Bear', 711, 790, 'woods');
        addToLookupTable('Mother bear and cubs', 791, 800, 'woods');
        addToLookupTable('Mouse', 81, 85, 'woods');
        addToLookupTable('Mouse', 801, 850, 'woods');
        addToLookupTable('Rabbit', 86, 90, 'woods');
        addToLookupTable('Rabbit', 851, 900, 'woods');
        addToLookupTable('Boar', 91, 99, 'woods');
        addToLookupTable('Boar', 901, 1000, 'woods');
        addToLookupTable('Forest fire', 100, 100, 'woods');

        function reroll(length) {
            let environment = document.querySelector('#environment').value;
            let res = pullFromLookupTable(length, environment);
            document.querySelector('#content').innerHTML = `${res.value} (${res.index})`; 
        }
    </script>
</body>
</html>
